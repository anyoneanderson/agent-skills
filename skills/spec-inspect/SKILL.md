---
name: spec-inspect
description: |
  Specification quality checker for spec-generator documents.

  Validates requirement.md, design.md, tasks.md for:
  - Requirement ID consistency and coverage
  - Mandatory section presence
  - Specification quality issues

  English triggers: "inspect specs", "check specification quality", "validate requirements"
  æ—¥æœ¬èªãƒˆãƒªã‚¬ãƒ¼: ã€Œä»•æ§˜æ›¸ã‚’æ¤œæŸ»ã€ã€Œå“è³ªãƒã‚§ãƒƒã‚¯ã€ã€Œä»•æ§˜ã‚’æ¤œè¨¼ã€
license: MIT
---

# spec-inspect

Automatic quality checker for specifications generated by spec-generator.

## When to Use

This skill should be invoked:
- After spec-generator completes (automatic suggestion)
- Before creating GitHub Issues with spec-to-issue
- When reviewing or updating specifications
- To ensure specification quality before implementation

## What It Does

Analyzes `.specs/{project-name}/` directory containing:
- requirement.md
- design.md
- tasks.md

**Checks Performed** (MVP):
1. **Requirement ID Validation** (Critical)
   - Detects references to non-existent requirement IDs
   - Identifies unused requirements

2. **Structure Validation** (Warning)
   - Verifies mandatory sections exist in each document
   - Ensures standard specification format

**Output**:
- Color-coded console report (â›” Critical, âš ï¸ Warning, â„¹ï¸ Info)
- Optional Markdown report file
- Exit code: 0 (success), 1 (critical issues found)

## Usage

### From spec-generator Workflow

After spec-generator completes, you'll be asked:
```
ä»•æ§˜æ›¸ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚
1. spec-inspectã§å“è³ªãƒã‚§ãƒƒã‚¯  ğŸ‘ˆ Select this
2. ã‚¹ã‚­ãƒƒãƒ—ã—ã¦spec-to-issueã§Issueç™»éŒ²
3. çµ‚äº†
```

### Direct Invocation

```bash
# Basic inspection
spec-inspect .specs/my-project

# Generate Markdown report
spec-inspect .specs/my-project -o report.md -f markdown

# Both console and report
spec-inspect .specs/my-project -o report.md -f both
```

### From Claude Code

User: "ä»•æ§˜æ›¸ã‚’æ¤œæŸ»ã—ã¦" or "Check spec quality"

## Output Example

```
ğŸ“‚ Loading specifications from .specs/spec-inspect...
âœ… Loaded project: spec-inspect

ğŸ” Running quality checks...
âœ… Checks complete: 2 issues found

æ¤œæŸ»çµæœã‚µãƒãƒªãƒ¼
  Total: 2 issues
  â›” Critical: 1
  âš ï¸  Warning: 1

â›” CRITICAL ISSUES

[CRITICAL-001] Requirement ID [REQ-999] does not exist
  ğŸ“„ design.md:45
  [REQ-999] is referenced in design.md but not defined in requirement.md
  ğŸ’¡ Add [REQ-999] to requirement.md or fix the reference

âš ï¸ WARNINGS

[WARNING-001] Missing mandatory section: éæ©Ÿèƒ½è¦ä»¶
  ğŸ“„ requirement.md:1
  Document should contain a 'éæ©Ÿèƒ½è¦ä»¶' section
  ğŸ’¡ Add a 'éæ©Ÿèƒ½è¦ä»¶' section to requirement.md
```

## Workflow Integration

```
spec-generator â†’ spec-inspect â†’ spec-to-issue
   (Generate)      (Validate)      (Publish)
```

**Conditional Flow**:
- âœ… No critical issues â†’ Proceed to spec-to-issue
- â›” Critical issues â†’ Fix specifications before Issue creation
- âš ï¸ Warnings only â†’ User decides whether to proceed

## Planned Features

Future releases will add:
- Contradiction detection across documents
- Ambiguous expression detection
- Coverage validation (requirements â†’ design â†’ tasks)
- Naming convention checks
- API naming consistency validation
- Documentation update analysis
- CLAUDE.md/AGENTS.md rule compliance

## Technical Details

**Implementation**:
- Python 3.10+
- markdown-it-py for robust Markdown parsing
- Pluggable check rule system
- Type-safe with mypy

**Architecture**:
- FileLoader: Load three specification files
- MarkdownParser: Parse to structured format
- CheckEngine: Execute validation rules
- ReportGenerator: Format results

**Check Rules** (Extensible):
- RequirementIDValidator
- StructureValidator
- [More rules coming soon...]

## Error Handling

- **File not found**: Clear error message with path
- **Invalid Markdown**: Graceful degradation, partial results
- **Check rule errors**: Logged but don't stop other checks

## Exit Codes

- `0`: Success (no critical issues)
- `1`: Critical issues found (implementation blocker)

## Notes

- This skill is designed to work seamlessly with spec-generator output format
- Markdown report can be committed to repository for team review
- Console output uses ANSI colors (may not display in all terminals)
- Specification format follows spec-generator conventions
