# Coding Rules

> Auto-generated by spec-rules-init.
> Source: {source_files}
> Generated: {timestamp}

## Testing Standards

### [MUST] Coverage Threshold
- Unit test coverage must be {coverage_target}% or above
- Source: {source_file}

### [MUST] Test Framework
- Use {test_framework} for all tests
- Source: {source_file}

### [SHOULD] Test Naming
- Describe behavior, not implementation
- Pattern: `should {expected behavior} when {condition}`

### [MAY] E2E Tests
- Use E2E tests for critical user flows
- Framework: {e2e_framework}

## Code Quality

### [MUST] Lint and Type Check
- `{lint_command}` must pass before commit
- `{typecheck_command}` must pass before commit
- Source: {source_file}

### [MUST] Naming Convention
- File names: {file_naming_convention} (e.g., kebab-case, camelCase)
- Variables/functions: {variable_naming_convention}
- Classes: PascalCase
- Source: {source_file}

### [SHOULD] No Unused Imports
- Remove all unused imports before commit

### [SHOULD] Import Style
- Use {import_style} imports (e.g., path alias `@/`, relative `./`)
- Source: {source_file}

### [SHOULD] No Heavy Operations in Loops
- Do not execute DB queries or API requests repeatedly inside loops
- Use batch processing or prefetching instead

### [SHOULD] No Magic Numbers
- Define all literal numbers and strings as named constants

### [SHOULD] Descriptive Naming
- Variable and function names must accurately represent their purpose
- Avoid vague names: `data`, `info`, `temp`, `result`

### [SHOULD] Concise Functions
- Each function should focus on a single responsibility and not be too long

### [SHOULD] DRY / KISS
- Avoid duplicating the same logic (Don't Repeat Yourself)
- Choose the simplest solution that works (Keep It Simple, Stupid)

### [SHOULD] No Dead Code
- Do not commit console.log, commented-out code, or dead code

## Error Handling

### [MUST] Error Logging
- All service methods must use structured error logging
- Use {logger} for error output
- Source: {source_file}

### [SHOULD] Exception Messages
- Exception messages in {exception_language}
- Include error context (operation, input summary)

### [SHOULD] Edge Case Handling
- Consider cases where arrays are empty, numbers are zero or negative, or values are null/undefined
- Verify behavior at boundary values

### [MAY] Custom Error Classes
- Define domain-specific error classes for distinct error categories

## Documentation

### [MUST] Public API Documentation
- All public methods must have {doc_format} (e.g., JSDoc, TSDoc, GoDoc)
- Include @param, @returns, @throws
- Source: {source_file}

### [SHOULD] Code Comments
- Comment language: {comment_language}
- Comment on "why", not "what"

### [MAY] Architecture Decision Records
- Document significant design decisions in ADR format

## Security

### [MUST] No Secrets in Logs
- Never log passwords, tokens, API keys, or client secrets
- Source: {source_file}

### [MUST] Input Validation
- Validate all external input at system boundaries
- Use {validation_library} for runtime validation

### [MUST] SQL Injection Prevention
- Never embed external input directly into SQL queries
- Use parameterized queries or ORM

### [MUST] XSS Prevention
- Never output external input directly into HTML
- Use output escaping or template engine auto-escaping

### [SHOULD] HTTPS Enforcement
- Validate redirect URIs use HTTPS (except localhost for development)

### [MAY] Dependency Audit
- Run dependency vulnerability checks periodically

## Git

### [MUST] Commit Message Format
- Format: Conventional Commits (`feat:`, `fix:`, `chore:`, `docs:`, `refactor:`, `test:`)
- Language priority:
  1. Follow language specified in CLAUDE.md / AGENTS.md / issue-to-pr-workflow.md
  2. If not specified, match the language of spec documents in the relevant .specs/ directory
  3. Fallback: {commit_language}
- Source: {source_file}

### [MUST] Branch Strategy
- Always work on feature branches, never commit directly to {main_branch}
- Branch naming: {branch_naming} (e.g., `feature/xxx`, `fix/xxx`)

### [SHOULD] Atomic Commits
- Each commit should represent a single logical change

---

## Sources

| File | Rules Extracted |
|------|----------------|
| {source_file_1} | {count_1} |
| {source_file_2} | {count_2} |

---

## Project-Type Recommendations

When the project uses specific frameworks, consider adding these rules:

### NestJS
- `[MUST]` Use NestJS Logger instead of console.log
- `[SHOULD]` Follow module-based architecture (feature modules)
- `[SHOULD]` Use class-validator for DTO validation
- `[SHOULD]` Use @ApiProperty with bilingual descriptions

### Next.js
- `[MUST]` Use App Router conventions (layout.tsx, page.tsx, loading.tsx)
- `[SHOULD]` Prefer Server Components by default, use `'use client'` only when needed
- `[SHOULD]` Use Next.js Image, Link components for optimization
- `[MAY]` Use Server Actions for form handling

### React (General)
- `[SHOULD]` Prefer functional components with hooks
- `[SHOULD]` Keep components small and focused (single responsibility)
- `[MAY]` Use custom hooks to extract reusable logic

### Go
- `[MUST]` Run `go vet` and `golint` before commit
- `[SHOULD]` Follow standard Go project layout
- `[SHOULD]` Handle all errors explicitly (no `_` for error returns)
- `[MAY]` Use table-driven tests

### Python
- `[MUST]` Pass `ruff` or `flake8` linting
- `[SHOULD]` Use type hints for all public functions
- `[SHOULD]` Follow PEP 8 naming conventions
- `[MAY]` Use dataclasses or Pydantic for data models

### Express / Fastify
- `[SHOULD]` Use middleware for cross-cutting concerns
- `[SHOULD]` Centralize error handling with error middleware
- `[MAY]` Use route-level validation with Zod or Joi
